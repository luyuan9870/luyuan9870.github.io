import{_ as t,c as d,o as a,a4 as r}from"./chunks/framework.BG61BEI0.js";const m=JSON.parse('{"title":"推荐搜索技术方案","description":"","frontmatter":{},"headers":[],"relativePath":"02-Person/00-业务学习/11-推荐系统/推荐系统搭建/推荐搜索技术方案.md","filePath":"02-Person/00-业务学习/11-推荐系统/推荐系统搭建/推荐搜索技术方案.md","lastUpdated":1715303929000}'),e={name:"02-Person/00-业务学习/11-推荐系统/推荐系统搭建/推荐搜索技术方案.md"},h=r('<h1 id="推荐搜索技术方案" tabindex="-1">推荐搜索技术方案 <a class="header-anchor" href="#推荐搜索技术方案" aria-label="Permalink to &quot;推荐搜索技术方案&quot;">​</a></h1><h1 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h1><p>调研方案</p><p><a href="https://docs.dingtalk.com/api/doc/transit?dentryUuid=AY39rGpMPmeVNQOpOpdkWOZkXKnaoNQ7&amp;queryString=utm_medium%3Ddingdoc_doc_plugin_card%26utm_source%3Ddingdoc_doc" target="_blank" rel="noreferrer">《推荐搜索技术调研》</a></p><h1 id="整体架构" tabindex="-1">整体架构 <a class="header-anchor" href="#整体架构" aria-label="Permalink to &quot;整体架构&quot;">​</a></h1><p>短期和中期都将围绕着这个模型进行规划开发，在项目初期会有一些模块进行简化或不做，会根据业务的需求来进行详细设计开发</p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/5abd5ad9d41649edb4095041791b7ef72400.png" alt="image" loading="lazy"></p><p><strong>聚合服务</strong></p><p>根据业务场景将原子服务聚合起来，对外提供服务。在项目初期使用硬编码，组合调用原子服务，项目中后期会将项目重构为可配置化，方便多种算法的按需接入与测试</p><p><strong>原子服务</strong></p><p>提供算法服务，将推荐搜索相关算法封装为业务服务。在项目初期会主要依赖elasticsearch提供的检索能力，项目中后期会新增更多意图理解、用户画像等算法来丰富系统能力</p><p><strong>存储</strong></p><p>主要是存储及检索原子服务需要的数据，在项目初期主要是包含es、redis、mysql等较为常见的组件，项目中后期会根据需要添加时序数据库、向量数据库、图数据库等来支持更复杂的算法和业务</p><p><strong>离/近线层</strong></p><p>采集并清洗数据，训练数据模型，为在线服务提供所需的数据支持。在项目早期主要是业务数据加载清洗转换，后续会逐渐搭建数据清洗和训练大数据平台，以方便更多数据源以及跟大数据量的处理</p><p><strong>系统支持</strong></p><p>为推荐搜索系统进行管理和监控，包括配置系统、A/B测试平台、监控告警系统等。配置系统用来控制推荐搜索需要的变量；A/B测试平台用来给不同用户分配对应的推荐搜索策略，同时对用户的点击率、转化率等进行统计对比，从而评估策略的效果；监控告警系统用来对系统运行情况进行告警，避免运维开发在系统出现故障后却不知道</p><h2 id="核心业务交互图" tabindex="-1">核心业务交互图 <a class="header-anchor" href="#核心业务交互图" aria-label="Permalink to &quot;核心业务交互图&quot;">​</a></h2><p><strong>搜索系统</strong></p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/cac60b6dd7ea4147aa0cc1fc444e18652400.png" alt="image" loading="lazy"></p><p>推荐系统</p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/4981b542df634683b3e63c7303ddfc742400.png" alt="image" loading="lazy"></p><p>推荐和搜索处理过程大体一致，推荐缺少了QR过程，但可以将用户画像当作隐藏query。</p><p>QU详细过程</p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/R42BvBvO4S7VkAEg/4ca32e26cd93402b98ed98179cb143b92400.png" alt="image" loading="lazy"></p><h2 id="系统架构" tabindex="-1">系统架构 <a class="header-anchor" href="#系统架构" aria-label="Permalink to &quot;系统架构&quot;">​</a></h2><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/536bcb301c4a4b94add5c21cc475df4e2400.png" alt="image" loading="lazy"></p><p>在线服务：直接对外提供服务，需要保证实时性和可靠性</p><p>近线服务：根据用户和商品的变动近线实时统计，近实时的对推荐搜索结果近线反馈，对用户信息变更有分钟级延时</p><p>离线服务：离线对用户数据和商品数据训练模型，然后将模型发不到线上，对用户信息变更有小时或天级延时</p><h1 id="方案演进" tabindex="-1">方案演进 <a class="header-anchor" href="#方案演进" aria-label="Permalink to &quot;方案演进&quot;">​</a></h1><p><strong>演进过程</strong></p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/e2070559df534c26bd309948ee9930412400.png" alt="image" loading="lazy"></p><h2 id="短中期业务对比" tabindex="-1">短中期业务对比 <a class="header-anchor" href="#短中期业务对比" aria-label="Permalink to &quot;短中期业务对比&quot;">​</a></h2><h3 id="搜索" tabindex="-1">搜索 <a class="header-anchor" href="#搜索" aria-label="Permalink to &quot;搜索&quot;">​</a></h3><table><thead><tr><th>分类</th><th>功能</th><th>子功能</th><th>短期(产品需求)</th><th>中期（行业通用）</th></tr></thead><tbody><tr><td>搜索前</td><td>底纹</td><td></td><td>无</td><td></td></tr><tr><td></td><td>搜索历史</td><td></td><td>待定</td><td>在浏览器本地记录用户搜索记录</td></tr><tr><td></td><td>热门搜索</td><td></td><td>待定</td><td>1. 根据用户输入的搜索内容，归一化后，按搜索量最大的内容倒排展示 2. 运营干预，配置要展示的搜索词</td></tr><tr><td>搜索中</td><td>搜索补全</td><td></td><td>无</td><td></td></tr><tr><td></td><td>查询处理</td><td>预处理</td><td>处理通用字符</td><td></td></tr><tr><td></td><td></td><td>分词</td><td>基于词典的分词</td><td></td></tr><tr><td></td><td></td><td>联想</td><td>无</td><td></td></tr><tr><td></td><td></td><td>归一</td><td>无</td><td></td></tr><tr><td></td><td></td><td>纠错</td><td>无</td><td></td></tr><tr><td></td><td></td><td>意图识别</td><td>无</td><td></td></tr><tr><td></td><td></td><td>运营干预</td><td>配置同义词</td><td>1. 配置同义词 2. 关键字匹配返回</td></tr><tr><td></td><td>召回</td><td>匹配规则</td><td>1. 匹配算法 bm25 2. 权重         商品标题：6         Sku号：1        品牌：1        副标题：5        商品规格属性：3        商品描述属性：2        商品分类名称：4</td><td>1. 文本匹配 2. embedding 词匹配</td></tr><tr><td></td><td></td><td>粗排</td><td>1. hot排序：按权重降序，两周销量降序，商品上架时间降序，商品无库存沉底； （默认） 2. New排序：按商品上架时间降序，商品无库存沉底； 3. 价格排序：    Low to High：本店售价升序，权重降序，商品上架时间降序；         High to Low：本店售价降序，权重降序，添加时间降序</td><td></td></tr><tr><td></td><td>排序</td><td>打分</td><td>权重        商品标题：6        Sku号：1        品牌：1        副标题：5        商品规格属性：3        商品描述属性：2        商品分类名称：4</td><td></td></tr><tr><td></td><td></td><td>运营干预</td><td>无</td><td></td></tr><tr><td>搜索后</td><td>引导</td><td>类目</td><td>无</td><td></td></tr><tr><td></td><td></td><td>排序</td><td>hot排序、New排序、价格排序</td><td></td></tr><tr><td></td><td>无结果展示</td><td></td><td>待定</td><td></td></tr></tbody></table><h3 id="推荐" tabindex="-1">推荐 <a class="header-anchor" href="#推荐" aria-label="Permalink to &quot;推荐&quot;">​</a></h3><table><thead><tr><th>功能</th><th>短期</th><th>中期</th><th>问题</th></tr></thead><tbody><tr><td>热卖</td><td></td><td>1. 统计最近一段时间销量最好的商品</td><td>T+1?</td></tr><tr><td>新品上线</td><td></td><td></td><td>T+1?分类目不</td></tr><tr><td>猜你喜欢</td><td></td><td></td><td>1. 根据用户浏览商品类目 topN 2. 近邻推荐</td></tr><tr><td>看了又看</td><td></td><td></td><td>推荐逻辑？怎么判断对不对</td></tr><tr><td>买了又买</td><td></td><td></td><td>怎么判断？</td></tr><tr><td>运营干预</td><td></td><td></td><td>插入条目</td></tr><tr><td>最近查看</td><td></td><td></td><td>是不是需要推荐搜索来做</td></tr></tbody></table><h3 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h3><h2 id="短中期技术对比" tabindex="-1">短中期技术对比 <a class="header-anchor" href="#短中期技术对比" aria-label="Permalink to &quot;短中期技术对比&quot;">​</a></h2><h3 id="搜索-1" tabindex="-1">搜索 <a class="header-anchor" href="#搜索-1" aria-label="Permalink to &quot;搜索&quot;">​</a></h3><table><thead><tr><th>维度或功能</th><th>短期</th><th>中期</th></tr></thead><tbody><tr><td>目的</td><td>1. 推荐搜索信息相关性，可以根据文本匹配和商品特征直接找出相关 2. 可靠性，线上能够支持预估的峰值流，超过预估峰值时能够进行系统保护，避免直接崩溃 3. 鲁棒性，能够在无法覆盖的场景下，给出有意义的商品（如：热门商品、营销商品）</td><td>1. 可配置化，多种算法和策略 2. 可量化</td></tr><tr><td>底纹</td><td>运营配置</td><td>个性化推荐热销</td></tr><tr><td>搜索历史</td><td>1.用户输入过的查询条件</td><td>1.用户输入过的查询条件</td></tr><tr><td>热门搜索</td><td>运营配置 or 热门商品推荐</td><td>根据nlp处理，对热门搜索进行展示</td></tr><tr><td>查询处理</td><td>基于文本匹配的纠错、建议、归一</td><td>基于nlp的纠错、建议、联想、归一</td></tr><tr><td>召回</td><td>按照BM25文本匹配算法在es中搜索商品名称、类目和详情</td><td>基于B25文本匹配、knn召回</td></tr><tr><td>打分排序</td><td>B25文本匹配度打分</td><td>xgboost排序</td></tr><tr><td>无结果展示</td><td>猜你喜欢</td><td>nlp的纠错并搜索或猜你喜欢</td></tr></tbody></table><h3 id="推荐-1" tabindex="-1">推荐 <a class="header-anchor" href="#推荐-1" aria-label="Permalink to &quot;推荐&quot;">​</a></h3><table><thead><tr><th>维度或功能</th><th>短期</th><th>中期</th></tr></thead><tbody><tr><td>热卖</td><td>使用T+1离线统计每周销售量与购买人数最多最好的商品</td><td>个性化推荐，基于用户画像，推荐用户感兴趣品类中</td></tr><tr><td>新品上线</td><td>拉取最近上线的商品，并跟根据运营配置的</td><td></td></tr><tr><td>猜你喜欢</td><td>1. 根据用户观看和购买的物品品类进行 2. 冷启动算法直接推荐热卖商品</td><td>对用户进行分群，基于协同过滤算法进行推荐</td></tr><tr><td>看了又看</td><td>基于用户最近观看的商品品类进行推荐</td><td>对用户和商品进行分群，</td></tr><tr><td>买了又买</td><td>基于用户最近购买商品的品类进行推荐</td><td>对用户和商品进行分群，基于协同过滤，推荐买了改商品的人还会买哪些商品</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="总结-1" tabindex="-1">总结 <a class="header-anchor" href="#总结-1" aria-label="Permalink to &quot;总结&quot;">​</a></h3><p>功能图对比</p><h2 id="" tabindex="-1"><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/6f1d8e9777bc4829a46701e33cbc75f72400.png" alt="image" loading="lazy"> <a class="header-anchor" href="#" aria-label="Permalink to &quot;![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/6f1d8e9777bc4829a46701e33cbc75f72400.png)&quot;">​</a></h2><p>Milvus:  是一款开源向量数据库，赋能 AI 应用和向量相似度搜索</p><p>xgboost：是一个优化分布式梯度提升库，设计高效、灵活、便携。可以用来组合不同算法召回的结果</p><h1 id="短期方案设计" tabindex="-1">短期方案设计 <a class="header-anchor" href="#短期方案设计" aria-label="Permalink to &quot;短期方案设计&quot;">​</a></h1><h2 id="功能" tabindex="-1">功能 <a class="header-anchor" href="#功能" aria-label="Permalink to &quot;功能&quot;">​</a></h2><table><thead><tr><th>功能</th><th>需求</th><th>实现方案</th></tr></thead><tbody><tr><td>底纹</td><td></td><td></td></tr><tr><td>搜索历史</td><td></td><td></td></tr><tr><td>热门搜索</td><td></td><td></td></tr><tr><td>搜索补全</td><td></td><td></td></tr><tr><td>预处理</td><td>1.    特殊字符参与搜索：（$%&amp;()_+/&#39;-.把特殊字符当通用符号处理）？ 2.   当搜索词中带有停止词时，分词需过滤掉</td><td>1. 在QR模块中去除特殊字符 2. 在es中配置词干提取器来消除大小写、单复数、</td></tr><tr><td>分词</td><td>1. 英语按照单词分词 2. 忽略单复数</td><td>1. es 配置filter stop,hunspell</td></tr><tr><td>联想</td><td></td><td></td></tr><tr><td>归一</td><td></td><td></td></tr><tr><td>纠错</td><td></td><td></td></tr><tr><td>意图识别</td><td></td><td></td></tr><tr><td>运营干预</td><td>1. 搜索词单复数和同义词搜索词，搜索结果保持一致；（同义词OBS后台可配）</td><td>1. 在QR模块中改写同义词</td></tr><tr><td>匹配规则</td><td>1.  匹配算法 bm25 2.  权重         商品标题：6         Sku号：1        品牌：1        副标题：5        商品规格属性：3        商品描述属性：2        商品分类名称：4</td><td></td></tr><tr><td>粗排</td><td>1. hot排序：按权重降序，两周销量降序，商品上架时间降序，商品无库存沉底； （默认） 2. New排序：按商品上架时间降序，商品无库存沉底； 3. 价格排序：    Low to High：本店售价升序，权重降序，商品上架时间降序；         High to Low：本店售价降序，权重降序，添加时间降序</td><td></td></tr><tr><td>打分</td><td></td><td></td></tr><tr><td>运营干预</td><td></td><td></td></tr><tr><td>类目</td><td></td><td></td></tr><tr><td>排序</td><td></td><td></td></tr><tr><td>无结果展示</td><td></td><td></td></tr></tbody></table><h2 id="应用架构" tabindex="-1">应用架构 <a class="header-anchor" href="#应用架构" aria-label="Permalink to &quot;应用架构&quot;">​</a></h2><p>有哪些应用，有哪些接口，实现接口的应用是如何交互的</p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/056e0ce74b1148c5a0864e14e1695ff42400.png" alt="image" loading="lazy"></p><p>实现接口的交互流程是如何跟内部的数据模型结合在一起的，确保数据模型能够完全支撑覆盖业务场景</p><p>query 查询流程</p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/c5e18de2174b4f71b21077c0186d4f372400.png" alt="image" loading="lazy"></p><h2 id="推荐位位置" tabindex="-1">推荐位位置 <a class="header-anchor" href="#推荐位位置" aria-label="Permalink to &quot;推荐位位置&quot;">​</a></h2><table><thead><tr><th>推荐位</th><th>页面</th><th>位置</th><th>说明</th></tr></thead><tbody><tr><td>热卖</td><td>首页</td><td></td><td></td></tr><tr><td>猜你喜欢</td><td>商品详情</td><td></td><td></td></tr><tr><td>新品上线</td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="重点问题" tabindex="-1">重点问题 <a class="header-anchor" href="#重点问题" aria-label="Permalink to &quot;重点问题&quot;">​</a></h2><p>快速回滚</p><p>价格、库存大规模配置错误如何快速恢复</p><p>冷启动</p><p>没有数据如何推荐</p><h1 id="中期方案设计" tabindex="-1">中期方案设计 <a class="header-anchor" href="#中期方案设计" aria-label="Permalink to &quot;中期方案设计&quot;">​</a></h1><h2 id="应用" tabindex="-1">应用 <a class="header-anchor" href="#应用" aria-label="Permalink to &quot;应用&quot;">​</a></h2><h2 id="数据模型-清洗" tabindex="-1">数据模型&amp;清洗 <a class="header-anchor" href="#数据模型-清洗" aria-label="Permalink to &quot;数据模型&amp;清洗&quot;">​</a></h2><p>数据</p><p><img src="https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/a/pL1eNkeJXhg4YBEx/7aa623da11504d7180801b7ac6547bb52400.png" alt="image" loading="lazy"></p><h2 id="在线服务" tabindex="-1">在线服务 <a class="header-anchor" href="#在线服务" aria-label="Permalink to &quot;在线服务&quot;">​</a></h2><h2 id="页面埋点" tabindex="-1">页面埋点 <a class="header-anchor" href="#页面埋点" aria-label="Permalink to &quot;页面埋点&quot;">​</a></h2><table><thead><tr><th>事件名称</th><th>页面</th><th>目的</th></tr></thead><tbody><tr><td>商品页面加载</td><td>商品页面</td><td>用户商品访问记录</td></tr><tr><td>点击加购物车</td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h1 id="部署计划" tabindex="-1">部署计划 <a class="header-anchor" href="#部署计划" aria-label="Permalink to &quot;部署计划&quot;">​</a></h1><table><thead><tr><th>应用</th><th>描述</th><th>数量</th><th>cpu</th><th>内存</th><th>网络</th><th>磁盘</th></tr></thead><tbody><tr><td>search-soa-common</td><td>搜索聚合服务</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>basic-soa-search</td><td>搜索原子服务</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>recommend-soa-common</td><td>推荐聚合服务</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>basic-soa-recommend</td><td>推荐原子服务</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>search-recommend-admin</td><td>搜索推荐管理端</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>search-loader</td><td>数据加载清洗服务</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>中间件</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>elasticsearch</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>redis</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>mysql</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>kafka</td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h1 id="排期" tabindex="-1">排期 <a class="header-anchor" href="#排期" aria-label="Permalink to &quot;排期&quot;">​</a></h1><table><thead><tr><th>月份</th><th>主要工作</th><th>task</th><th>进度</th></tr></thead><tbody><tr><td>7月</td><td>技术调研、出方案、基架搭建</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>8月</td><td>方案评审、业务评审、业务无关开发</td><td></td><td></td></tr><tr><td>9月</td><td>业务开发</td><td></td><td></td></tr><tr><td>10月</td><td>联调、收尾、测试</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table>',77),o=[h];function i(l,n,s,c,p,b){return a(),d("div",null,o)}const g=t(e,[["render",i]]);export{m as __pageData,g as default};
