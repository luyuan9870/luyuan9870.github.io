import{_ as a,c as s,o as n,a4 as e}from"./chunks/framework.BG61BEI0.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"01-Dev/01.08-数据库/02-Mysql/碎片清理方案.md","filePath":"01-Dev/01.08-数据库/02-Mysql/碎片清理方案.md","lastUpdated":1712823825000}'),l={name:"01-Dev/01.08-数据库/02-Mysql/碎片清理方案.md"},t=e(`<h2 id="目标" tabindex="-1">目标 <a class="header-anchor" href="#目标" aria-label="Permalink to &quot;目标&quot;">​</a></h2><p>清理 mysql 碎片空间，优化实例性能；减少磁盘使用量，及备份空间容量。</p><h2 id="方案策略" tabindex="-1">方案策略 <a class="header-anchor" href="#方案策略" aria-label="Permalink to &quot;方案策略&quot;">​</a></h2><ol><li>MySQL 5.7 的 innodb 支持 online DDL 的整理碎片期间写锁会降级为读锁，几乎不影响 DML；myisam 整理碎片期间加写锁影响 DML。</li><li>为了安全期间，操作在备库执行。 执行计划</li><li>备库上清理碎片操作</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>SET GLOBAL super_read_only=0;  # 临时关闭超级用户只读</span></span>
<span class="line"><span>SET SESSION sql_log_bin=OFF;  # 本session操作不记入binlog</span></span>
<span class="line"><span></span></span>
<span class="line"><span>OPTIMIZE TABLE &quot;表名&quot;;  # 重建表、重新整理索引信息</span></span>
<span class="line"><span></span></span>
<span class="line"><span>SET GLOBAL super_read_only=1;</span></span>
<span class="line"><span>QUIT;</span></span></code></pre></div><ol start="2"><li>主备切换</li><li>新备库上清理碎片</li></ol>`,6),i=[t];function p(o,_,c,r,d,h){return n(),s("div",null,i)}const S=a(l,[["render",p]]);export{m as __pageData,S as default};
